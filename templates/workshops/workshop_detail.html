{% extends 'workshops/base.html' %}
{% block title %}{{ workshop.title }}{% endblock %}
{% block content %}
<div class="d-flex justify-content-between align-items-center">
  <h2>{{ workshop.title }}</h2>
  <span class="badge bg-{% if workshop.status == 'live' %}success{% elif workshop.status == 'completed' %}secondary{% else %}info{% endif %}">{{ workshop.get_status_display }}</span>
</div>
<div class="text-muted mb-2">{{ workshop.start_date }}{% if workshop.end_date %} - {{ workshop.end_date }}{% endif %} â€¢ {{ workshop.get_mode_display }}</div>
<div class="mb-3">
  <div><strong>Coordinator:</strong> {{ workshop.coordinator.get_full_name|default:workshop.coordinator.username }}</div>
  <div><strong>Contact:</strong> {{ workshop.coordinator_email }} | {{ workshop.coordinator_phone }}</div>
  <div><strong>Location:</strong> {{ workshop.city }} {{ workshop.state }} {{ workshop.institute }}</div>
  {% if workshop.mode == 'online' and workshop.online_link %}
    <div><a href="{{ workshop.online_link }}" target="_blank">Join online</a></div>
  {% endif %}
</div>
{% if workshop.registration_link %}
  <a class="btn btn-success btn-sm" href="{{ workshop.registration_link }}" target="_blank">Registration</a>
{% endif %}
{% if workshop.agenda_pdf %}
  <a class="btn btn-outline-primary btn-sm" href="{{ workshop.agenda_pdf.url }}" target="_blank">Agenda (PDF)</a>
{% endif %}
{% if workshop.feedback_form_link %}
  <a class="btn btn-outline-secondary btn-sm" href="{{ workshop.feedback_form_link }}" target="_blank">Feedback Form</a>
{% endif %}

{% if user.is_authenticated and (user.is_superuser or user.id == workshop.coordinator_id) %}
  <div class="mt-3">
    <a class="btn btn-primary btn-sm" href="{% url 'workshop-edit' workshop.pk %}">Edit</a>
    <a class="btn btn-secondary btn-sm" href="{% url 'workshop-uploads' workshop.pk %}">Manage Uploads</a>
  </div>
{% endif %}

<hr>
<h4>Photos</h4>
<div class="row row-cols-2 row-cols-md-4 g-2">
  {% for p in workshop.photos.all %}
  <div class="col">
    <div class="card">
      <img src="{{ p.image.url }}" class="card-img-top" alt="{{ p.caption }}">
      {% if p.caption %}<div class="card-body p-2 small">{{ p.caption }}</div>{% endif %}
    </div>
  </div>
  {% empty %}
  <p>No photos uploaded yet.</p>
  {% endfor %}
</div>

<h4 class="mt-4">Documents</h4>
<ul>
  {% for d in workshop.documents.all %}
    <li><a href="{{ d.file.url }}" target="_blank">{{ d.get_doc_type_display }}</a> <span class="text-muted small">({{ d.uploaded_at|date:"Y-m-d H:i" }})</span></li>
  {% empty %}
    <li>No documents uploaded yet.</li>
  {% endfor %}
</ul>
{% endblock %}
